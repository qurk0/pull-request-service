# Проект: тестовое задание Avito Tech 2025 Autumn

Данный проект является реализацией сервиса для управления PullRequest'ами.

ВАЖНОЕ УТОЧНЕНИЕ: Это первая версия от 15.11.2025 22:05. Я очень устал, так как сижу над проектом с 9 утра, поэтому я очень хочу спатки. Важно сказать, что сейчас готова первая версия сервиса. Завтра, 16.11.2025, я сделаю Docker-compose, чтобы можно было поднимать всё одним docker compose up -d, в котором будут миграции, все нужные зависимости, а так же запущены сервис и БД, после чего приступлю к написанию тестов и тестированием сервиса на корректность работы. Потом приступлю к доп. заданиям по типу сбора статистик, нагрузочному тестированию, чем бы оно ни было, а заодно прокину логгер.

## Стек технологий, которые использованы в данном проекте:
1. **Язык программирования:** Go
- - Библиотеки: cleanenv, fiber, jackx/pgx/v5
2. **База данных:** PostgreSQL (+ миграции с помощью Goose)
3. **Контейнеризация с помощью Docker:** на момент создания коммита нет ничего, кроме директории Docker. Потом напишу 3 файла: докер компоуз для развертывания всего проекта и 2 докерфайла для сборки сервиса и мигратора

## Эндпоинты, которые я не знаю - стоит заносить в документацию или нет, но сказать о них надо
1. /metrics - возвращает метрики. Тут я старался использовать prometheus-метрики с кастомными счётчиками в пакете internal/metrics

## Принятые решения в рамках разработки проекта
1. Переменная LOGLEVEL в ENV-переменных, по умолчанию будет стоять LevelInfo, если вдруг захочется взять другой уровень логирования - в docker-compose.yml меняем LOGLEVEL на уровень: 'warn', 'error', 'debug' (пока что только строчные литеры работают, в дальнейшем может будет свободный регистр в переменных окружения и буду всё к lowerCase приводить, пока не до этого)

2. При создании команды если встречаем ID существующих членов команды - обновляем данные по ним: меняем username (возможно сделаю unique и не буду менять), team_name и is_active.

### Нагрузочное тестирование

Проводил с помощью hey:

hey -n 20 -c 5 \
  -m POST \
  -H "Content-Type: application/json" \
  -d '{
    "team_name": "backend",
    "members": [
      {
        "user_id": "u1",
        "username": "Alice",
        "is_active": true
      },
      {
        "user_id": "u2",
        "username": "Bob",
        "is_active": true
      },
      {
        "user_id": "u3",
        "username": "Charlie",
        "is_active": true
      }
    ]
  }' \
  http://localhost:8080/team/add

hey -n 20 -c 5 \
  "http://localhost:8080/team/get?team_name=backend"

hey -n 20 -c 5 \
  -m POST \
  -H "Content-Type: application/json" \
  -d '{
    "user_id": "u2",
    "is_active": false
  }' \
  http://localhost:8080/users/setIsActive          

### E2E тестирование